# noqa

import datetime
import os

import numpy as np


def run_gse(year: int, month: int, day: int, datapath: str, out_dir: str) -> None:
    dayw = datetime.datetime(year, month, day).weekday()

    srcList = [
        "aircraft",
        "rail",
        "shipping",
        "motor_vehicles",
        "crematoria",
        "petcrematoria",
        "industry_diffuse",
        "woodheater",
        "architect_coating",
        "bakery",
        "charcoal",
        "cutback_bitumen",
        "domestic_solvents",
        "dry_cleaning",
        "gas_leak",
        "panel_beaters",
        "printing",
        "servos",
        "pizza",
        "vicbakery",
    ]
    srcLongName = [
        "Aircraft",
        "Locomotives",
        "shipping",
        "motor vehicles",
        "crematoria",
        "petcrematoria",
        "industry",
        "woodheater",
        "architect coatings",
        "bakery",
        "charcoal",
        "cutback bitumen",
        "domestic solvents",
        "dry cleaning",
        "gas leak",
        "panel beaters",
        "printing",
        "servos",
        "pizza",
        "vicbakery",
    ]

    # fmt: off
    # No vars:
    nvars = [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]

    # fmt: on
    # Species order
    spOrder = np.array(
        [
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
            [2, 5, 4, 1, 3, 2],
        ]
    )

    # Setup spaemis_glo files for Perth inventory"
    # Species set
    spSet = np.array(
        [
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
            [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000],
        ]
    )
    # fmt: off
    # VOC speciation factors:
    # 'OLE','IOLE','PAR','TOL','XYL','FORM','ALD2','ALDX','ISOP','ETH','ETHA','MEOH','ETOH','UNR'
    voc = np.array([
        [0.00432,0.00000,0.02913,0.00135,0.00100,0.03638,0.01326,0.0,0.0,0.00867,0.0,0.00426,0.0,0.90161],
        [0.00923,0.00000,0.06308,0.00438,0.00413,0.05756,0.03226,0.0,0.0,0.03292,0.0,0.00036,0.00006,0.79602],
        [0.00365,0.00000,0.10452,0.02759,0.03812,0.00674,0.01043,0.0,0.0,0.00432,0.0,0.00125,0.00025,0.80314],
        [0.00257,0.00000,0.05722,0.00521,0.00594,0.00996,0.01561,0.0,0.00004,0.00449,0.0,0.00105,0.00046,0.89744],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00035,0.00000,0.04584,0.00591,0.00337,0.00295,0.00289,0.0,0.0,0.00073,0.0,0.0067,0.00577,0.92549],
        [0.00419,0.00000,0.02144,0.00290,0.00143,0.04818,0.03605,0.0,0.00025,0.00754,0.0,0.0,0.0,0.87801],
        [0.00000,0.00000,0.69057,0.09482,0.01947,0.00000,0.00000,0.0,0.0,0.0,0.0,0.03895,0.00599,0.0],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00354,0.00000,0.19311,0.02230,0.02308,0.00480,0.02055,0.0,0.0,0.00162,0.0,0.05112,0.14581,0.53407],
        [0.00354,0.00000,0.19311,0.02230,0.02308,0.00480,0.02055,0.0,0.0,0.00162,0.0,0.05112,0.14581,0.53407],
        [0.00051,0.00179,0.12303,0.09730,0.00681,0.00000,0.00000,0.00001,0.0,0.01843,0.0,0.07131,0.02137,0.0],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.04243,0.00121,0.54301,0.04045,0.02453,0.02728,0.00000,0.0,0.0,0.0025,0.03003,0.00811,0.00396,0.09984],
        [0.00354,0.00000,0.19311,0.02230,0.02308,0.00480,0.02055,0.0,0.0,0.00162,0.0,0.05112,0.14581,0.53407],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991],
        [0.00346,0.00000,0.02484,0.00014,0.00027,0.01711,0.00233,0.0,0.0,0.00193,0.0,0.0,0.0,0.94991]
    ])

    # PM10 speciation factors:
    # OC25, OC10, EC25, EC10, OT25, OT10, SO4, AS10
    pm10 = np.array([
        [0.03376,0.07231,0.02506,0.01001,0.16181,0.67903,0.01569,0.00080],
        [0.03376,0.07231,0.02506,0.01001,0.16181,0.67903,0.01569,0.00080],
        [0.03376,0.07231,0.02506,0.01001,0.16181,0.67903,0.01569,0.00080],
        [0.03376,0.07231,0.02506,0.01001,0.16181,0.67903,0.01569,0.00080],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.03376,0.07231,0.02506,0.01001,0.16181,0.67903,0.01569,0.00080],
        [0.403497,0.015503,0.145413,0.005587,0.415053,0.015947,0.000468,1.8e-05],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.030000,0.070000,0.030000,0.070000,0.240000,0.560000,0.000437,0.001021],
        [0.679655,0.000000,0.024988,0.000000,0.294922,0.000000,0.030992,0.000000],
        [0.679655,0.00000,0.0249880,0.000000,0.294922,0.000000,0.030992,0.000000]
    ])

    # [0.679655,0.00000,0.0249880,0.000000,0.294922,0.000000,0.030992,0.000000]])
    # Air toxic and levoglucosan speciation:
    # TOL, XYL, BNZ, LEVO
    # PTOL/VOC,PXYL/VOC,PBNZ/VOC,LEVO/VOC
    tox = np.array([
        [0.0011,0.0005,0.0004,0.0000],
        [0.0035,0.0021,0.0013,0.0000],
        [0.0221,0.0191,0.0083,0.0000],
        [0.0042,0.0030,0.0016,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0047,0.0017,0.0018,0.0000],
        [0.0023,0.0007,0.0009,0.0251],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0178,0.0115,0.0067,0.0000],
        [0.0001,0.0003,0.0000,0.0000],
        [0.0001,0.0003,0.0000,0.0000]
    ])

    # Srtup temporal factors

    # No. days in month
    monthdays = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]
    # Monthly Ratios:
    monthly = [
        [0.0810,0.0808,0.0890,0.0819,0.0902,0.0778,0.0869,0.0841,0.0811,0.0851,0.0825,0.0796],
        [0.0826,0.0779,0.0802,0.0841,0.0868,0.0811,0.0859,0.0828,0.0851,0.0870,0.0818,0.0848],
        [0.0806,0.0760,0.0844,0.0829,0.0852,0.0806,0.0798,0.0890,0.0798,0.0913,0.0837,0.0867],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0036,0.0157,0.0277,0.0398,0.1054,0.1711,0.2367,0.1756,0.1144,0.0532,0.0367,0.0202],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0707,0.0685,0.0790,0.0768,0.0918,0.0922,0.1080,0.0976,0.0870,0.0813,0.0756,0.0715],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0917,0.0917,0.0851,0.0792,0.0792,0.0792,0.0792,0.0792,0.0792,0.0792,0.0851,0.0917],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833],
        [0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833,0.0833]
    ]

    # Daily Ratios:
    daily = [
        [0.1411,0.1498,0.1530,0.1503,0.1483,0.1271,0.1304],
        [0.1460,0.1690,0.1652,0.1627,0.1581,0.1080,0.0909],
        [0.1414,0.1446,0.1447,0.1426,0.1466,0.1431,0.1370],
        [0.1490,0.1490,0.1490,0.1490,0.1490,0.1276,0.1276],
        [0.1824,0.1824,0.1824,0.1824,0.1824,0.0878,0.0000],
        [0.1824,0.1824,0.1824,0.1824,0.1824,0.0878,0.0000],
        [0.1824,0.1824,0.1824,0.1824,0.1824,0.0878,0.0000],
        [0.1403,0.1403,0.1403,0.1403,0.1403,0.1487,0.1499],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1900,0.1900,0.1900,0.1900,0.1900,0.0500,0.0000],
        [0.1667,0.1667,0.1667,0.1667,0.1667,0.1667,0.0000],
        [0.1852,0.1852,0.1852,0.1852,0.1852,0.0370,0.0370],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429],
        [0.1429,0.1429,0.1429,0.1429,0.1429,0.1429,0.1429]
    ]
    # Weekend Hourly Fractions:
    hwkend = np.array([
    [0.00100,0.00110,0.00110,0.00070,0.00200,0.02300,0.05070,0.06770,0.07930,0.08520,0.08340,0.08110,0.06920,0.07360,0.07850,0.07100,0.05610,0.05340,0.04660,0.03190,0.02360,0.01700,0.00160,0.00130],
    [0.08340,0.08370,0.08350,0.07910,0.01380,0.00950,0.00280,0.00040,0.00690,0.04120,0.03900,0.04210,0.04050,0.03430,0.00360,0.00310,0.00270,0.00720,0.05460,0.06700,0.07100,0.07100,0.07810,0.08160],
    [0.04110,0.04140,0.04170,0.04180,0.04200,0.04230,0.04260,0.04280,0.04280,0.04260,0.04240,0.04210,0.04170,0.04160,0.04160,0.04150,0.04150,0.04130,0.04120,0.04110,0.04090,0.04080,0.04060,0.04070],
    [0.01280,0.00610,0.00360,0.00190,0.00510,0.01060,0.01680,0.03570,0.06580,0.05820,0.06530,0.07460,0.07020,0.06800,0.06640,0.08400,0.08240,0.08960,0.06270,0.03950,0.02510,0.02050,0.02250,0.01250],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.04066,0.04066,0.03993,0.03993,0.03992,0.03992,0.03992,0.03992,0.03994,0.04103,0.04359,0.04360,0.04360,0.04360,0.04360,0.04360,0.04360,0.04360,0.04253,0.04251,0.04251,0.04074,0.04079,0.04066],
    [0.03356,0.02488,0.02561,0.02554,0.02554,0.02593,0.02615,0.02861,0.03419,0.03895,0.03989,0.04038,0.04032,0.04033,0.04103,0.04245,0.04515,0.05050,0.06071,0.06715,0.06842,0.06762,0.06182,0.04528],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170],
    [0.01670,0.01670,0.01670,0.01670,0.01670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.01670,0.01670,0.01670,0.01670,0.01670,0.01670,0.01670],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.16667,0.16667,0.16667,0.16667,0.16667,0.16667,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.00120,0.00080,0.00050,0.00120,0.00610,0.02430,0.04860,0.08010,0.08260,0.05460,0.05100,0.05160,0.05220,0.05100,0.04980,0.07290,0.08140,0.07290,0.07890,0.04860,0.03160,0.02190,0.01820,0.01210],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000],
    [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000]])

    # Weekday Hourly Fractions:
    hwkday = np.array([
        [0.00270,0.00180,0.00250,0.00180,0.00420,0.03490,0.06000,0.07130,0.07160,0.06980,0.06930,0.06870,0.05590,0.06200,0.06830,0.06700,0.06010,0.06670,0.05680,0.03870,0.02990,0.02380,0.00670,0.00550],
        [0.08340,0.08370,0.08350,0.07910,0.01380,0.00950,0.00280,0.00040,0.00690,0.04120,0.03900,0.04210,0.04050,0.03430,0.00360,0.00310,0.00270,0.00720,0.05460,0.06700,0.07100,0.07100,0.07810,0.08160],
        [0.04110,0.04140,0.04170,0.04180,0.04200,0.04230,0.04260,0.04280,0.04280,0.04260,0.04240,0.04210,0.04170,0.04160,0.04160,0.04150,0.04150,0.04130,0.04120,0.04110,0.04090,0.04080,0.04060,0.04070],
        [0.00420,0.00190,0.00130,0.00100,0.00560,0.02130,0.04140,0.08360,0.10440,0.05600,0.04590,0.04700,0.04430,0.04660,0.05400,0.08240,0.08480,0.09490,0.06850,0.04070,0.02370,0.01880,0.01900,0.00880],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.04066,0.04066,0.03993,0.03993,0.03992,0.03992,0.03992,0.03992,0.03994,0.04103,0.04359,0.04360,0.04360,0.04360,0.04360,0.04360,0.04360,0.04360,0.04253,0.04251,0.04251,0.04074,0.04079,0.04066],
        [0.03356,0.02488,0.02561,0.02554,0.02554,0.02593,0.02615,0.02861,0.03419,0.03895,0.03989,0.04038,0.04032,0.04033,0.04103,0.04245,0.04515,0.05050,0.06071,0.06715,0.06842,0.06762,0.06182,0.04528],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170,0.04170],
        [0.01670,0.01670,0.01670,0.01670,0.01670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.06670,0.01670,0.01670,0.01670,0.01670,0.01670,0.01670,0.01670],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167,0.04167],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.09091,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.00120,0.00080,0.00050,0.00120,0.00610,0.02430,0.04860,0.08010,0.08260,0.05460,0.05100,0.05160,0.05220,0.05100,0.04980,0.07290,0.08140,0.07290,0.07890,0.04860,0.03160,0.02190,0.01820,0.01210],
        [0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.10000,0.00000,0.00000,0.00000,0.00000,0.00000],
        [0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.12500,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000]
    ])

    # fmt: on

    for i, sector in enumerate(srcList):
        with open(os.path.join(out_dir, f"{sector}.run"), "w") as fh:
            myval = (
                monthly[i][month - 1] / (monthdays[month - 1] / 7.0) * daily[i][dayw]
            )
            input_datafile = os.path.join(datapath, f"{sector}__tif_to_csv3.csv")
            fh.write(
                f"Victoria emissions from {srcLongName[i]}. VOCs are lumped for Carbon Bond V\n"
                + "user grid- nx, ny, x0, y0, dx, dy (x0,y0- sw cell centre; all coordinates in decimal degrees lat/long\n"  # noqa
                + "903,592,140.6291,-39.5402,0.01059988,0.01059988\n"
                + "name of spatial factor file, number of spatial factor columns\n"
                + f"{input_datafile}\n"
                + f"{nvars[i]}\n"
                + "name of the generated .gse file\n"
                + f"{sector}.in\n"
                + "five lines of comments\n"
                + "Victoria emissions for selected source. VOCs are lumped for Carbon Bond V\n"
                + "Speciation factors are taken from the 2008 Sydney region inventory\n"
                + "Diurnal factors also taken from ...\n"
                + "Inventory is in UTC and is on a spherical domain\n"
                + f"{srcLongName[i]} only\n"
                + "ASCII output?\n"
                + "F\n"
                + "Internal emissions table is as follows.\n"
                + "nems=41\n"
                + """'NO  ','NO2 ','CO  ','SO2 ','PART',\n"""
                + """'PAR ','ETH ','OLE ','ISOP','TOL ',\n"""
                + """'XYL ','HCHO','ALD2','MEOH','ETOH',\n"""
                + """'NR'  ,'NH3 ','ETHA','IOLE','ALDX',\n"""
                + """'OC25','OC10','EC25','EC10','OT25',\n"""
                + """'OT10','ASO4','AS10','APA1','APA2',\n"""
                + """'APA3','APA4','APA5','APA6','APA7',\n"""
                + """'APA8','APA9','PTOL','PXYL','PBNZ',\n"""
                + """'LEVO'\n"""
                + "CTM species output to gse files. Map to speciation tables\n"
                + "Number of emission species\n"
                + "44\n"
                + "Names of emission species\n"
                + "Mapping to speciation tables (-1 = no mapping)- this is for NSW\n"
                + "NO  ,1,NO2 ,2,CO  ,3,SO2 ,4,PART,5,ALD2,13,ETH ,7,FORM,12,ISOP,9,OLE ,8\n"
                + "PAR ,6,TOL ,10,XYL ,11,ETOH,15,MEOH,14,UNR ,16,NH3 ,17,ETHA,18,IOLE,19,ALDX,20\n"
                + "OC25,21,OC10,22,EC25,23,EC10,24,OT25,25,OT10,26,ASO4,27,AS10,28,APA1,29,APA2,30\n"
                + "APA3,31,APA4,32,APA5,33,APA6,34,APA7,35,APA8,36,APA9,37,PTOL,38,PXYL,39,PBNZ,40\n"
                + "LEVO,41,SOX1,4,SOX2,4,SOX3,4\n"
                + "Species pointers to data columns in the input file\n"
                + "Species emission factors (generally kg/yr/cell -> kg/day/cell\n"
                + "NOx,     VOC,       PM,       CO,      SO2,     NH3"
            )
            mycols = np.reshape(spOrder[i], (1, 6))
            np.savetxt(fh, mycols, fmt="%i", delimiter=",")
            a = np.repeat(myval, 6)
            a = a * spSet[i]
            rates = np.reshape(a, (1, 6))
            np.savetxt(fh, rates, fmt="%.8f", delimiter=",")
            fh.write(
                "NOx speciation\n"
                + "NO and NO2 mass fractions\n"
                + "0.587,0.100\n"
                + "VOC speciation\n"
                + "OLE,IOLE,PAR,TOL,XYL,FORM,ALD2,ALDX,ISOP,ETH,ETHA,MEOH,ETOH,UNR"
            )
            a = voc[i]
            myvoc = np.reshape(a, (1, 14))
            np.savetxt(fh, myvoc, fmt="%.8f", delimiter=",")
            fh.write("PM speciation" + "\n" + "OC25,OC10,EC25,EC10,OT25,OT10,ASO4,AS10")
            a = pm10[i]
            mypm = np.reshape(a, (1, 8))
            np.savetxt(fh, mypm, fmt="%.8f", delimiter=",")
            fh.write(
                "Air toxic and levoglucosan speciation (of VOC)\n"
                + "TOL   XYL   BNZ   LEVO"
            )
            a = tox[i]
            mytox = np.reshape(a, (1, 4))
            np.savetxt(fh, mytox, fmt="%.8f", delimiter=",")
            fh.write(
                "Volatility basis set speciation (nine decadal bins)\n"
                + "C* = {0.01, 0.01,0.1,1.0,10,100,1000,10000,100000,1000000} (ug/m3)"
            )
            if srcList[i] == "woodheater":
                a = np.asarray([0.0, 0.0, 0.160, 0.224, 0.528, 0.528, 0.160, 0.0, 0.0])
            else:
                a = np.asarray(
                    [0.048, 0.096, 0.144, 0.224, 0.288, 0.480, 0.640, 0.800, 1.280]
                )
            myvol = np.reshape(a, (1, 9))
            np.savetxt(fh, myvol, fmt="%.8f", delimiter=",")
            fh.write(
                "GLOMAP parameters\n"
                + "sulfate. n-modes, (mode_no,d(nm),g-sig,frac, for each mode)\n"
                + "allowable modes are 1,2,3,4 (nucls,aits,accs,coas)\n"
                + "2, 3,150.,1.59,0.5, 4,1500.,2.0,0.5\n"
                + "ec+oc. n-modes, (mode_no,d(nm),g-sig,frac, for each mode)\n"
                + "allowable modes are 5 (aitki)\n"
                + "1,5,60.,1.59,1.0\n"
                + "du. n-modes, (mode_no,d(nm),g-sig,frac, for each mode)\n"
                + "allowable modes are 6, 7 (acci,coai)\n"
                + "1,6,150.,1.59,1.0\n"
                + "Diurnal profile of emissions\n"
                + "The profile is normalised and is for local standard time"
            )
            if dayw > 5:  # noqa
                a = hwkend[i]
            else:
                a = hwkday[i]
            myhour = np.reshape(a, (4, 6))
            np.savetxt(fh, myhour, fmt="%.8f", delimiter=",", newline=",\n")
